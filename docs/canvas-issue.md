# 小程序 canvas 覆盖问题说明

## 现象
在复利计算器页面中，图表使用 `canvas` 渲染。页面向上滚动时，`canvas` 会覆盖下方的表格区域，即便图表容器已经离开可视区域或尝试调整 `z-index`。

## 原因
微信小程序的 `canvas` 属于原生层组件，与普通 `view`（视图层）存在层级差异：

- 原生层渲染不会严格遵循普通视图层的裁剪、`z-index` 或 `overflow` 规则。
- 当页面滚动时，`canvas` 可能仍然绘制在视图层之上，导致覆盖下方内容。

因此，单纯通过 CSS 控制位置或层级，无法可靠解决覆盖问题。

## 尝试过的方案
1. **导出为图片再展示**
   - 通过 `canvasToTempFilePath` / `toTempFilePath` 导出图片，再用 `<image>` 展示。
   - 结果：在开发者工具和真机上都出现 `canvas is empty`，导出失败不稳定。

2. **滚动时动态隐藏 canvas**
   - 在表格接近图表区域时移除 `canvas`，避免覆盖。
   - 有效，但体验不如预期（需要提前隐藏）。

## 最终方案（已采用）
改用纯视图层绘制折线图：

- 使用 `view` 组合网格、坐标轴、标签、折线段、终点圆点。
- 折线通过多段绝对定位 `view` + `transform: rotate()` 实现。
- 该方案完全在视图层内渲染，不再受原生层覆盖影响。

## 结果
- 图表不会再覆盖表格。
- 滚动行为与其它视图一致。
- 代价是实现复杂度更高、需要自行计算坐标与线段。

## 结论
小程序内 `canvas` 覆盖问题属于原生层限制，无法单纯用 CSS 解决。若需要可靠的层级控制，建议使用视图层绘制或导出图片方案（前者更稳定）。
